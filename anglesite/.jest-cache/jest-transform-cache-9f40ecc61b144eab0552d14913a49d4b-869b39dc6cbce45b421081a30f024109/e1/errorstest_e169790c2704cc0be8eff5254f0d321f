cbdf82bdd679bace1fd27349b56130cf
"use strict";
/**
 * @file Error System Tests
 *
 * Tests for the structured error handling system including base errors,
 * domain-specific errors, utilities, and error management.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const errors_1 = require("../../../app/core/errors");
describe('Error System', () => {
    describe('Base AngleError', () => {
        class TestError extends errors_1.AngleError {
            constructor(message) {
                super(message, 'TEST_ERROR', errors_1.ErrorCategory.SYSTEM, errors_1.ErrorSeverity.MEDIUM);
            }
        }
        it('should create error with basic properties', () => {
            const error = new TestError('Test message');
            expect(error.message).toBe('Test message');
            expect(error.code).toBe('TEST_ERROR');
            expect(error.category).toBe(errors_1.ErrorCategory.SYSTEM);
            expect(error.severity).toBe(errors_1.ErrorSeverity.MEDIUM);
            expect(error.timestamp).toBeInstanceOf(Date);
            expect(error.name).toBe('TestError');
        });
        it('should serialize error properly', () => {
            const error = new TestError('Test message');
            const serialized = error.serialize();
            expect(serialized.name).toBe('TestError');
            expect(serialized.message).toBe('Test message');
            expect(serialized.code).toBe('TEST_ERROR');
            expect(serialized.category).toBe(errors_1.ErrorCategory.SYSTEM);
            expect(serialized.severity).toBe(errors_1.ErrorSeverity.MEDIUM);
            expect(serialized.metadata).toBeDefined();
        });
        it('should determine recoverability correctly', () => {
            const criticalError = new TestError('Critical');
            Object.defineProperty(criticalError, 'severity', { value: errors_1.ErrorSeverity.CRITICAL, configurable: true });
            const mediumError = new TestError('Medium');
            expect(criticalError.isRecoverable()).toBe(false);
            expect(mediumError.isRecoverable()).toBe(true);
        });
        it('should add context correctly', () => {
            const error = new TestError('Test message');
            error.addContext('userId', '123');
            error.addContext('operation', 'test');
            expect(error.metadata.context?.userId).toBe('123');
            expect(error.metadata.context?.operation).toBe('test');
        });
        it('should create error with context', () => {
            const error = new TestError('Test message');
            const contextError = error.withContext({ userId: '456', operation: 'update' });
            expect(contextError.metadata.context?.userId).toBe('456');
            expect(contextError.metadata.context?.operation).toBe('update');
            expect(contextError).not.toBe(error); // Should be a new instance
        });
    });
    describe('Domain-specific Errors', () => {
        it('should create WebsiteError with website context', () => {
            const error = new errors_1.WebsiteError('Website failed', 'WEBSITE_FAILED', 'site-123', '/path/to/site');
            expect(error.websiteId).toBe('site-123');
            expect(error.websitePath).toBe('/path/to/site');
            expect(error.code).toBe('WEBSITE_FAILED');
            expect(error.category).toBe(errors_1.ErrorCategory.BUSINESS_LOGIC);
        });
        it('should create WebsiteNotFoundError with proper defaults', () => {
            const error = new errors_1.WebsiteNotFoundError('site-456');
            expect(error.websiteId).toBe('site-456');
            expect(error.code).toBe('WEBSITE_NOT_FOUND');
            expect(error.message).toBe('Website not found: site-456');
            expect(error.severity).toBe(errors_1.ErrorSeverity.MEDIUM);
        });
        it('should create ServerError with port context', () => {
            const error = new errors_1.ServerError('Server failed', 'SERVER_FAILED', 3000, 'server-1');
            expect(error.port).toBe(3000);
            expect(error.serverId).toBe('server-1');
            expect(error.category).toBe(errors_1.ErrorCategory.SYSTEM);
        });
        it('should create ServerStartError with proper details', () => {
            const error = new errors_1.ServerStartError(8080, 'Port already in use');
            expect(error.port).toBe(8080);
            expect(error.code).toBe('SERVER_START_FAILED');
            expect(error.message).toBe('Failed to start server on port 8080: Port already in use');
        });
        it('should create AtomicOperationError with operation context', () => {
            const error = new errors_1.AtomicOperationError('Write failed', 'ATOMIC_WRITE_FAILED', 'writeFile', false, [
                '/tmp/test.tmp',
            ]);
            expect(error.operationType).toBe('writeFile');
            expect(error.rollbackPerformed).toBe(false);
            expect(error.temporaryPaths).toEqual(['/tmp/test.tmp']);
            expect(error.category).toBe(errors_1.ErrorCategory.ATOMIC_OPERATION);
        });
        it('should create FileNotFoundError with file path', () => {
            const error = new errors_1.FileNotFoundError('/path/to/file.txt');
            expect(error.path).toBe('/path/to/file.txt');
            expect(error.code).toBe('FILE_NOT_FOUND');
            expect(error.category).toBe(errors_1.ErrorCategory.FILE_SYSTEM);
        });
        it('should create validation errors with field context', () => {
            const requiredError = new errors_1.RequiredFieldError('email');
            expect(requiredError.field).toBe('email');
            expect(requiredError.code).toBe('REQUIRED_FIELD_MISSING');
            const formatError = new errors_1.InvalidFormatError('phone', '123', 'XXX-XXX-XXXX');
            expect(formatError.field).toBe('phone');
            expect(formatError.value).toBe('123');
            expect(formatError.code).toBe('INVALID_FORMAT');
        });
    });
    describe('ErrorUtils', () => {
        it('should wrap regular Error in AngleError', () => {
            const originalError = new Error('Original error');
            const wrappedError = errors_1.ErrorUtils.wrap(originalError);
            expect(wrappedError).toBeInstanceOf(errors_1.AngleError);
            expect(wrappedError.message).toBe('Original error');
            expect(wrappedError.code).toBe('WRAPPED_ERROR');
            expect(wrappedError.category).toBe(errors_1.ErrorCategory.SYSTEM);
        });
        it('should return AngleError unchanged when wrapping', () => {
            const angleError = new errors_1.WebsiteError('Test', 'TEST');
            const wrappedError = errors_1.ErrorUtils.wrap(angleError);
            expect(wrappedError).toBe(angleError);
        });
        it('should wrap string as error', () => {
            const wrappedError = errors_1.ErrorUtils.wrap('String error message');
            expect(wrappedError).toBeInstanceOf(errors_1.AngleError);
            expect(wrappedError.message).toBe('String error message');
            expect(wrappedError.code).toBe('UNKNOWN_ERROR');
        });
        it('should wrap error with context', () => {
            const error = new Error('Test error');
            const wrappedError = errors_1.ErrorUtils.wrap(error, { userId: '123', operation: 'test' });
            expect(wrappedError.metadata.context?.userId).toBe('123');
            expect(wrappedError.metadata.context?.operation).toBe('test');
        });
        it('should check error matches', () => {
            const websiteError = new errors_1.WebsiteError('Test', 'TEST');
            expect(errors_1.ErrorUtils.matches(websiteError, errors_1.WebsiteError)).toBe(true);
            expect(errors_1.ErrorUtils.matches(websiteError, errors_1.ServerError)).toBe(false);
            expect(errors_1.ErrorUtils.matches(websiteError, 'TEST')).toBe(true);
            expect(errors_1.ErrorUtils.matches(websiteError, 'OTHER')).toBe(false);
        });
        it('should format error for display', () => {
            const error = new errors_1.WebsiteError('Website failed', 'WEBSITE_FAILED', 'site-123');
            const formatted = errors_1.ErrorUtils.format(error);
            expect(formatted).toContain('[MEDIUM] BUSINESS_LOGIC:WEBSITE_FAILED');
            expect(formatted).toContain('Website failed');
            expect(formatted).toContain('websiteId=');
        });
        it('should convert error to log object', () => {
            const error = new errors_1.FileNotFoundError('/test/file.txt');
            const logObj = errors_1.ErrorUtils.toLogObject(error);
            expect(logObj.name).toBe('FileNotFoundError');
            expect(logObj.message).toBe('File not found: /test/file.txt');
            expect(logObj.code).toBe('FILE_NOT_FOUND');
            expect(logObj.category).toBe(errors_1.ErrorCategory.FILE_SYSTEM);
            expect(logObj.severity).toBe(errors_1.ErrorSeverity.MEDIUM);
            expect(logObj.metadata).toBeDefined();
        });
        it('should get error statistics', () => {
            const errors = [
                new errors_1.WebsiteError('Test 1', 'TEST_1'),
                new errors_1.ServerError('Test 2', 'TEST_2'),
                new errors_1.FileNotFoundError('/file'),
                new errors_1.WebsiteError('Test 3', 'TEST_3'),
            ];
            const stats = errors_1.ErrorUtils.getStatistics(errors);
            expect(stats.total).toBe(4);
            expect(stats.byCategory[errors_1.ErrorCategory.BUSINESS_LOGIC]).toBe(2);
            expect(stats.byCategory[errors_1.ErrorCategory.SYSTEM]).toBe(1);
            expect(stats.byCategory[errors_1.ErrorCategory.FILE_SYSTEM]).toBe(1);
            expect(stats.bySeverity[errors_1.ErrorSeverity.MEDIUM]).toBe(3);
            expect(stats.bySeverity[errors_1.ErrorSeverity.HIGH]).toBe(1); // ServerError defaults to HIGH
        });
        it('should group errors by category', () => {
            const errors = [
                new errors_1.WebsiteError('Test 1', 'TEST_1'),
                new errors_1.ServerError('Test 2', 'TEST_2'),
                new errors_1.WebsiteError('Test 3', 'TEST_3'),
            ];
            const grouped = errors_1.ErrorUtils.groupByCategory(errors);
            expect(grouped.get(errors_1.ErrorCategory.BUSINESS_LOGIC)).toHaveLength(2);
            expect(grouped.get(errors_1.ErrorCategory.SYSTEM)).toHaveLength(1);
        });
    });
    describe('Error Context Management', () => {
        afterEach(() => {
            errors_1.ErrorContextManager.clearAll();
        });
        it('should execute function with context', async () => {
            let capturedContext = {};
            await (0, errors_1.withContext)({ operation: 'test', userId: '123' }, async () => {
                capturedContext = errors_1.ErrorContextManager.getMergedContext();
                return 'success';
            });
            expect(capturedContext.operation).toBe('test');
            expect(capturedContext.userId).toBe('123');
        });
        it('should handle nested contexts', async () => {
            let innerContext = {};
            await (0, errors_1.withContext)({ operation: 'outer', userId: '123' }, async () => {
                await (0, errors_1.withContext)({ operation: 'inner', websiteId: 'site-456' }, async () => {
                    innerContext = errors_1.ErrorContextManager.getMergedContext();
                    return 'inner';
                });
                return 'outer';
            });
            expect(innerContext.operation).toBe('inner'); // Should override
            expect(innerContext.userId).toBe('123'); // Should inherit
            expect(innerContext.websiteId).toBe('site-456'); // Should be added
        });
        it('should clean up context stack properly', async () => {
            await (0, errors_1.withContext)({ operation: 'test' }, async () => {
                expect(errors_1.ErrorContextManager.getMergedContext().operation).toBe('test');
                return 'success';
            });
            // Context should be cleaned up
            expect(Object.keys(errors_1.ErrorContextManager.getMergedContext())).toHaveLength(0);
        });
    });
    describe('Error Retry Mechanism', () => {
        it('should succeed on first try', async () => {
            let attempts = 0;
            const result = await (0, errors_1.withRetry)(() => {
                attempts++;
                return 'success';
            }, 3, 100);
            expect(result).toBe('success');
            expect(attempts).toBe(1);
        });
        it('should retry on failure and eventually succeed', async () => {
            let attempts = 0;
            const result = await (0, errors_1.withRetry)(() => {
                attempts++;
                if (attempts < 3) {
                    throw new Error('Temporary failure');
                }
                return 'success';
            }, 3, 10);
            expect(result).toBe('success');
            expect(attempts).toBe(3);
        });
        it('should fail after max retries', async () => {
            let attempts = 0;
            await expect((0, errors_1.withRetry)(() => {
                attempts++;
                throw new Error('Persistent failure');
            }, 2, 10)).rejects.toThrow('Persistent failure');
            expect(attempts).toBe(3); // Initial attempt + 2 retries
        });
        it('should use error-specific retry delays', async () => {
            class NetworkTestError extends errors_1.AngleError {
                constructor() {
                    super('Network error', 'NETWORK_ERROR', errors_1.ErrorCategory.NETWORK);
                }
                getRetryDelay() {
                    return 50; // Custom delay
                }
                isRecoverable() {
                    return true; // Make sure it's recoverable for retries
                }
            }
            let attempts = 0;
            const startTime = Date.now();
            try {
                await (0, errors_1.withRetry)(() => {
                    attempts++;
                    throw new NetworkTestError();
                }, 1, 100 // This should be overridden by error's getRetryDelay()
                );
            }
            catch {
                // Expected to fail
            }
            const endTime = Date.now();
            expect(attempts).toBe(2);
            // Should have used custom delay of 50ms instead of 100ms
            expect(endTime - startTime).toBeLessThan(80);
        });
    });
    describe('Error Registration and Handling', () => {
        beforeEach(() => {
            // Clear any existing handlers
            // Clear handlers - accessing private property for testing
            errors_1.errorRegistry.handlers.clear();
        });
        it('should register and call error handlers', async () => {
            const handler = jest.fn();
            (0, errors_1.registerErrorHandler)('WebsiteError', handler);
            const error = new errors_1.WebsiteError('Test error', 'TEST');
            await errors_1.errorRegistry.handleError(error);
            expect(handler).toHaveBeenCalledWith(error);
        });
        it('should call global error handlers', async () => {
            const globalHandler = jest.fn();
            const specificHandler = jest.fn();
            (0, errors_1.registerErrorHandler)('*', globalHandler);
            (0, errors_1.registerErrorHandler)('ServerError', specificHandler);
            const websiteError = new errors_1.WebsiteError('Test', 'TEST');
            const serverError = new errors_1.ServerError('Test', 'TEST');
            await errors_1.errorRegistry.handleError(websiteError);
            await errors_1.errorRegistry.handleError(serverError);
            expect(globalHandler).toHaveBeenCalledTimes(2);
            expect(specificHandler).toHaveBeenCalledTimes(1);
            expect(specificHandler).toHaveBeenCalledWith(serverError);
        });
        it('should handle handler errors gracefully', async () => {
            const faultyHandler = jest.fn(() => {
                throw new Error('Handler error');
            });
            (0, errors_1.registerErrorHandler)('WebsiteError', faultyHandler);
            const error = new errors_1.WebsiteError('Test', 'TEST');
            // Should not throw despite handler error
            await expect(errors_1.errorRegistry.handleError(error)).resolves.toBeUndefined();
            expect(faultyHandler).toHaveBeenCalled();
        });
    });
    describe('Error Serialization and Deserialization', () => {
        it('should serialize and deserialize error correctly', () => {
            const originalError = new errors_1.WebsiteNotFoundError('site-123', {
                operation: 'loadWebsite',
                context: { userId: '456' },
            });
            const serialized = originalError.serialize();
            const deserialized = errors_1.ErrorUtils.fromSerialized(serialized);
            expect(deserialized.message).toBe(originalError.message);
            expect(deserialized.code).toBe(originalError.code);
            expect(deserialized.category).toBe(originalError.category);
            expect(deserialized.severity).toBe(originalError.severity);
            expect(deserialized.name).toBe(originalError.name);
            expect(deserialized.metadata.operation).toBe('loadWebsite');
            expect(deserialized.metadata.context?.userId).toBe('456');
        });
        it('should handle nested error serialization', () => {
            const cause = new Error('Root cause');
            const wrappedCause = errors_1.ErrorUtils.wrap(cause);
            const topError = new errors_1.WebsiteError('Top level', 'TOP_LEVEL', undefined, undefined, undefined, undefined, wrappedCause);
            const serialized = topError.serialize();
            expect(serialized.cause).toBeDefined();
            expect(serialized.cause?.message).toBe('Root cause');
            const deserialized = errors_1.ErrorUtils.fromSerialized(serialized);
            expect(deserialized.getRootCause().message).toBe('Root cause');
        });
        it('should convert to JSON properly', () => {
            const error = new errors_1.ServerStartError(3000, 'Port in use');
            const jsonString = JSON.stringify(error);
            const parsed = JSON.parse(jsonString);
            expect(parsed.name).toBe('ServerStartError');
            expect(parsed.message).toBe('Failed to start server on port 3000: Port in use');
            expect(parsed.code).toBe('SERVER_START_FAILED');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2R3ay9EZXZlbG9wZXIvZ2l0bGFiLmNvbS9kYXZpZHdrZWl0aC9AZHdrL2FuZ2xlc2l0ZS90ZXN0L2FwcC9jb3JlL2Vycm9ycy50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7QUFFSCxxREFrQmtDO0FBRWxDLFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO0lBQzVCLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsTUFBTSxTQUFVLFNBQVEsbUJBQVU7WUFDaEMsWUFBWSxPQUFlO2dCQUN6QixLQUFLLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxzQkFBYSxDQUFDLE1BQU0sRUFBRSxzQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQzNFLENBQUM7U0FDRjtRQUVELEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7WUFDbkQsTUFBTSxLQUFLLEdBQUcsSUFBSSxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7WUFFNUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsc0JBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxzQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlD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QUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtZQUN6QyxNQUFNLEtBQUssR0FBRyxJQUFJLHlCQUFnQixDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztZQUN4RCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxrREFBa0QsQ0FBQyxDQUFDO1lBQ2hGLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9kd2svRGV2ZWxvcGVyL2dpdGxhYi5jb20vZGF2aWR3a2VpdGgvQGR3ay9hbmdsZXNpdGUvdGVzdC9hcHAvY29yZS9lcnJvcnMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIEVycm9yIFN5c3RlbSBUZXN0c1xuICpcbiAqIFRlc3RzIGZvciB0aGUgc3RydWN0dXJlZCBlcnJvciBoYW5kbGluZyBzeXN0ZW0gaW5jbHVkaW5nIGJhc2UgZXJyb3JzLFxuICogZG9tYWluLXNwZWNpZmljIGVycm9ycywgdXRpbGl0aWVzLCBhbmQgZXJyb3IgbWFuYWdlbWVudC5cbiAqL1xuXG5pbXBvcnQge1xuICBBbmdsZUVycm9yLFxuICBFcnJvclNldmVyaXR5LFxuICBFcnJvckNhdGVnb3J5LFxuICBFcnJvclV0aWxzLFxuICBXZWJzaXRlRXJyb3IsXG4gIFdlYnNpdGVOb3RGb3VuZEVycm9yLFxuICBTZXJ2ZXJFcnJvcixcbiAgU2VydmVyU3RhcnRFcnJvcixcbiAgQXRvbWljT3BlcmF0aW9uRXJyb3IsXG4gIEZpbGVOb3RGb3VuZEVycm9yLFxuICBSZXF1aXJlZEZpZWxkRXJyb3IsXG4gIEludmFsaWRGb3JtYXRFcnJvcixcbiAgd2l0aENvbnRleHQsXG4gIHdpdGhSZXRyeSxcbiAgZXJyb3JSZWdpc3RyeSxcbiAgcmVnaXN0ZXJFcnJvckhhbmRsZXIsXG4gIEVycm9yQ29udGV4dE1hbmFnZXIsXG59IGZyb20gJy4uLy4uLy4uL2FwcC9jb3JlL2Vycm9ycyc7XG5cbmRlc2NyaWJlKCdFcnJvciBTeXN0ZW0nLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdCYXNlIEFuZ2xlRXJyb3InLCAoKSA9PiB7XG4gICAgY2xhc3MgVGVzdEVycm9yIGV4dGVuZHMgQW5nbGVFcnJvciB7XG4gICAgICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgJ1RFU1RfRVJST1InLCBFcnJvckNhdGVnb3J5LlNZU1RFTSwgRXJyb3JTZXZlcml0eS5NRURJVU0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGVycm9yIHdpdGggYmFzaWMgcHJvcGVydGllcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFRlc3RFcnJvcignVGVzdCBtZXNzYWdlJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdUZXN0IG1lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChlcnJvci5jb2RlKS50b0JlKCdURVNUX0VSUk9SJyk7XG4gICAgICBleHBlY3QoZXJyb3IuY2F0ZWdvcnkpLnRvQmUoRXJyb3JDYXRlZ29yeS5TWVNURU0pO1xuICAgICAgZXhwZWN0KGVycm9yLnNldmVyaXR5KS50b0JlKEVycm9yU2V2ZXJpdHkuTUVESVVNKTtcbiAgICAgIGV4cGVjdChlcnJvci50aW1lc3RhbXApLnRvQmVJbnN0YW5jZU9mKERhdGUpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ1Rlc3RFcnJvcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZXJpYWxpemUgZXJyb3IgcHJvcGVybHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBUZXN0RXJyb3IoJ1Rlc3QgbWVzc2FnZScpO1xuICAgICAgY29uc3Qgc2VyaWFsaXplZCA9IGVycm9yLnNlcmlhbGl6ZSgpO1xuXG4gICAgICBleHBlY3Qoc2VyaWFsaXplZC5uYW1lKS50b0JlKCdUZXN0RXJyb3InKTtcbiAgICAgIGV4cGVjdChzZXJpYWxpemVkLm1lc3NhZ2UpLnRvQmUoJ1Rlc3QgbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHNlcmlhbGl6ZWQuY29kZSkudG9CZSgnVEVTVF9FUlJPUicpO1xuICAgICAgZXhwZWN0KHNlcmlhbGl6ZWQuY2F0ZWdvcnkpLnRvQmUoRXJyb3JDYXRlZ29yeS5TWVNURU0pO1xuICAgICAgZXhwZWN0KHNlcmlhbGl6ZWQuc2V2ZXJpdHkpLnRvQmUoRXJyb3JTZXZlcml0eS5NRURJVU0pO1xuICAgICAgZXhwZWN0KHNlcmlhbGl6ZWQubWV0YWRhdGEpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVybWluZSByZWNvdmVyYWJpbGl0eSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBjcml0aWNhbEVycm9yID0gbmV3IFRlc3RFcnJvcignQ3JpdGljYWwnKTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjcml0aWNhbEVycm9yLCAnc2V2ZXJpdHknLCB7IHZhbHVlOiBFcnJvclNldmVyaXR5LkNSSVRJQ0FMLCBjb25maWd1cmFibGU6IHRydWUgfSk7XG5cbiAgICAgIGNvbnN0IG1lZGl1bUVycm9yID0gbmV3IFRlc3RFcnJvcignTWVkaXVtJyk7XG5cbiAgICAgIGV4cGVjdChjcml0aWNhbEVycm9yLmlzUmVjb3ZlcmFibGUoKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QobWVkaXVtRXJyb3IuaXNSZWNvdmVyYWJsZSgpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhZGQgY29udGV4dCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBUZXN0RXJyb3IoJ1Rlc3QgbWVzc2FnZScpO1xuICAgICAgZXJyb3IuYWRkQ29udGV4dCgndXNlcklkJywgJzEyMycpO1xuICAgICAgZXJyb3IuYWRkQ29udGV4dCgnb3BlcmF0aW9uJywgJ3Rlc3QnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLm1ldGFkYXRhLmNvbnRleHQ/LnVzZXJJZCkudG9CZSgnMTIzJyk7XG4gICAgICBleHBlY3QoZXJyb3IubWV0YWRhdGEuY29udGV4dD8ub3BlcmF0aW9uKS50b0JlKCd0ZXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBlcnJvciB3aXRoIGNvbnRleHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBUZXN0RXJyb3IoJ1Rlc3QgbWVzc2FnZScpO1xuICAgICAgY29uc3QgY29udGV4dEVycm9yID0gZXJyb3Iud2l0aENvbnRleHQoeyB1c2VySWQ6ICc0NTYnLCBvcGVyYXRpb246ICd1cGRhdGUnIH0pO1xuXG4gICAgICBleHBlY3QoY29udGV4dEVycm9yLm1ldGFkYXRhLmNvbnRleHQ/LnVzZXJJZCkudG9CZSgnNDU2Jyk7XG4gICAgICBleHBlY3QoY29udGV4dEVycm9yLm1ldGFkYXRhLmNvbnRleHQ/Lm9wZXJhdGlvbikudG9CZSgndXBkYXRlJyk7XG4gICAgICBleHBlY3QoY29udGV4dEVycm9yKS5ub3QudG9CZShlcnJvcik7IC8vIFNob3VsZCBiZSBhIG5ldyBpbnN0YW5jZVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRG9tYWluLXNwZWNpZmljIEVycm9ycycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBXZWJzaXRlRXJyb3Igd2l0aCB3ZWJzaXRlIGNvbnRleHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBXZWJzaXRlRXJyb3IoJ1dlYnNpdGUgZmFpbGVkJywgJ1dFQlNJVEVfRkFJTEVEJywgJ3NpdGUtMTIzJywgJy9wYXRoL3RvL3NpdGUnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLndlYnNpdGVJZCkudG9CZSgnc2l0ZS0xMjMnKTtcbiAgICAgIGV4cGVjdChlcnJvci53ZWJzaXRlUGF0aCkudG9CZSgnL3BhdGgvdG8vc2l0ZScpO1xuICAgICAgZXhwZWN0KGVycm9yLmNvZGUpLnRvQmUoJ1dFQlNJVEVfRkFJTEVEJyk7XG4gICAgICBleHBlY3QoZXJyb3IuY2F0ZWdvcnkpLnRvQmUoRXJyb3JDYXRlZ29yeS5CVVNJTkVTU19MT0dJQyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBXZWJzaXRlTm90Rm91bmRFcnJvciB3aXRoIHByb3BlciBkZWZhdWx0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFdlYnNpdGVOb3RGb3VuZEVycm9yKCdzaXRlLTQ1NicpO1xuXG4gICAgICBleHBlY3QoZXJyb3Iud2Vic2l0ZUlkKS50b0JlKCdzaXRlLTQ1NicpO1xuICAgICAgZXhwZWN0KGVycm9yLmNvZGUpLnRvQmUoJ1dFQlNJVEVfTk9UX0ZPVU5EJyk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnV2Vic2l0ZSBub3QgZm91bmQ6IHNpdGUtNDU2Jyk7XG4gICAgICBleHBlY3QoZXJyb3Iuc2V2ZXJpdHkpLnRvQmUoRXJyb3JTZXZlcml0eS5NRURJVU0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgU2VydmVyRXJyb3Igd2l0aCBwb3J0IGNvbnRleHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBTZXJ2ZXJFcnJvcignU2VydmVyIGZhaWxlZCcsICdTRVJWRVJfRkFJTEVEJywgMzAwMCwgJ3NlcnZlci0xJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5wb3J0KS50b0JlKDMwMDApO1xuICAgICAgZXhwZWN0KGVycm9yLnNlcnZlcklkKS50b0JlKCdzZXJ2ZXItMScpO1xuICAgICAgZXhwZWN0KGVycm9yLmNhdGVnb3J5KS50b0JlKEVycm9yQ2F0ZWdvcnkuU1lTVEVNKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIFNlcnZlclN0YXJ0RXJyb3Igd2l0aCBwcm9wZXIgZGV0YWlscycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFNlcnZlclN0YXJ0RXJyb3IoODA4MCwgJ1BvcnQgYWxyZWFkeSBpbiB1c2UnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnBvcnQpLnRvQmUoODA4MCk7XG4gICAgICBleHBlY3QoZXJyb3IuY29kZSkudG9CZSgnU0VSVkVSX1NUQVJUX0ZBSUxFRCcpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0ZhaWxlZCB0byBzdGFydCBzZXJ2ZXIgb24gcG9ydCA4MDgwOiBQb3J0IGFscmVhZHkgaW4gdXNlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBBdG9taWNPcGVyYXRpb25FcnJvciB3aXRoIG9wZXJhdGlvbiBjb250ZXh0JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQXRvbWljT3BlcmF0aW9uRXJyb3IoJ1dyaXRlIGZhaWxlZCcsICdBVE9NSUNfV1JJVEVfRkFJTEVEJywgJ3dyaXRlRmlsZScsIGZhbHNlLCBbXG4gICAgICAgICcvdG1wL3Rlc3QudG1wJyxcbiAgICAgIF0pO1xuXG4gICAgICBleHBlY3QoZXJyb3Iub3BlcmF0aW9uVHlwZSkudG9CZSgnd3JpdGVGaWxlJyk7XG4gICAgICBleHBlY3QoZXJyb3Iucm9sbGJhY2tQZXJmb3JtZWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGVycm9yLnRlbXBvcmFyeVBhdGhzKS50b0VxdWFsKFsnL3RtcC90ZXN0LnRtcCddKTtcbiAgICAgIGV4cGVjdChlcnJvci5jYXRlZ29yeSkudG9CZShFcnJvckNhdGVnb3J5LkFUT01JQ19PUEVSQVRJT04pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgRmlsZU5vdEZvdW5kRXJyb3Igd2l0aCBmaWxlIHBhdGgnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBGaWxlTm90Rm91bmRFcnJvcignL3BhdGgvdG8vZmlsZS50eHQnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnBhdGgpLnRvQmUoJy9wYXRoL3RvL2ZpbGUudHh0Jyk7XG4gICAgICBleHBlY3QoZXJyb3IuY29kZSkudG9CZSgnRklMRV9OT1RfRk9VTkQnKTtcbiAgICAgIGV4cGVjdChlcnJvci5jYXRlZ29yeSkudG9CZShFcnJvckNhdGVnb3J5LkZJTEVfU1lTVEVNKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIHZhbGlkYXRpb24gZXJyb3JzIHdpdGggZmllbGQgY29udGV4dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVpcmVkRXJyb3IgPSBuZXcgUmVxdWlyZWRGaWVsZEVycm9yKCdlbWFpbCcpO1xuICAgICAgZXhwZWN0KHJlcXVpcmVkRXJyb3IuZmllbGQpLnRvQmUoJ2VtYWlsJyk7XG4gICAgICBleHBlY3QocmVxdWlyZWRFcnJvci5jb2RlKS50b0JlKCdSRVFVSVJFRF9GSUVMRF9NSVNTSU5HJyk7XG5cbiAgICAgIGNvbnN0IGZvcm1hdEVycm9yID0gbmV3IEludmFsaWRGb3JtYXRFcnJvcigncGhvbmUnLCAnMTIzJywgJ1hYWC1YWFgtWFhYWCcpO1xuICAgICAgZXhwZWN0KGZvcm1hdEVycm9yLmZpZWxkKS50b0JlKCdwaG9uZScpO1xuICAgICAgZXhwZWN0KGZvcm1hdEVycm9yLnZhbHVlKS50b0JlKCcxMjMnKTtcbiAgICAgIGV4cGVjdChmb3JtYXRFcnJvci5jb2RlKS50b0JlKCdJTlZBTElEX0ZPUk1BVCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3JVdGlscycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHdyYXAgcmVndWxhciBFcnJvciBpbiBBbmdsZUVycm9yJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxFcnJvciA9IG5ldyBFcnJvcignT3JpZ2luYWwgZXJyb3InKTtcbiAgICAgIGNvbnN0IHdyYXBwZWRFcnJvciA9IEVycm9yVXRpbHMud3JhcChvcmlnaW5hbEVycm9yKTtcblxuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvcikudG9CZUluc3RhbmNlT2YoQW5nbGVFcnJvcik7XG4gICAgICBleHBlY3Qod3JhcHBlZEVycm9yLm1lc3NhZ2UpLnRvQmUoJ09yaWdpbmFsIGVycm9yJyk7XG4gICAgICBleHBlY3Qod3JhcHBlZEVycm9yLmNvZGUpLnRvQmUoJ1dSQVBQRURfRVJST1InKTtcbiAgICAgIGV4cGVjdCh3cmFwcGVkRXJyb3IuY2F0ZWdvcnkpLnRvQmUoRXJyb3JDYXRlZ29yeS5TWVNURU0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gQW5nbGVFcnJvciB1bmNoYW5nZWQgd2hlbiB3cmFwcGluZycsICgpID0+IHtcbiAgICAgIGNvbnN0IGFuZ2xlRXJyb3IgPSBuZXcgV2Vic2l0ZUVycm9yKCdUZXN0JywgJ1RFU1QnKTtcbiAgICAgIGNvbnN0IHdyYXBwZWRFcnJvciA9IEVycm9yVXRpbHMud3JhcChhbmdsZUVycm9yKTtcblxuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvcikudG9CZShhbmdsZUVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgd3JhcCBzdHJpbmcgYXMgZXJyb3InLCAoKSA9PiB7XG4gICAgICBjb25zdCB3cmFwcGVkRXJyb3IgPSBFcnJvclV0aWxzLndyYXAoJ1N0cmluZyBlcnJvciBtZXNzYWdlJyk7XG5cbiAgICAgIGV4cGVjdCh3cmFwcGVkRXJyb3IpLnRvQmVJbnN0YW5jZU9mKEFuZ2xlRXJyb3IpO1xuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvci5tZXNzYWdlKS50b0JlKCdTdHJpbmcgZXJyb3IgbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvci5jb2RlKS50b0JlKCdVTktOT1dOX0VSUk9SJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHdyYXAgZXJyb3Igd2l0aCBjb250ZXh0JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcbiAgICAgIGNvbnN0IHdyYXBwZWRFcnJvciA9IEVycm9yVXRpbHMud3JhcChlcnJvciwgeyB1c2VySWQ6ICcxMjMnLCBvcGVyYXRpb246ICd0ZXN0JyB9KTtcblxuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvci5tZXRhZGF0YS5jb250ZXh0Py51c2VySWQpLnRvQmUoJzEyMycpO1xuICAgICAgZXhwZWN0KHdyYXBwZWRFcnJvci5tZXRhZGF0YS5jb250ZXh0Py5vcGVyYXRpb24pLnRvQmUoJ3Rlc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2hlY2sgZXJyb3IgbWF0Y2hlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHdlYnNpdGVFcnJvciA9IG5ldyBXZWJzaXRlRXJyb3IoJ1Rlc3QnLCAnVEVTVCcpO1xuXG4gICAgICBleHBlY3QoRXJyb3JVdGlscy5tYXRjaGVzKHdlYnNpdGVFcnJvciwgV2Vic2l0ZUVycm9yKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChFcnJvclV0aWxzLm1hdGNoZXMod2Vic2l0ZUVycm9yLCBTZXJ2ZXJFcnJvcikpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KEVycm9yVXRpbHMubWF0Y2hlcyh3ZWJzaXRlRXJyb3IsICdURVNUJykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoRXJyb3JVdGlscy5tYXRjaGVzKHdlYnNpdGVFcnJvciwgJ09USEVSJykpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgZXJyb3IgZm9yIGRpc3BsYXknLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBXZWJzaXRlRXJyb3IoJ1dlYnNpdGUgZmFpbGVkJywgJ1dFQlNJVEVfRkFJTEVEJywgJ3NpdGUtMTIzJyk7XG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSBFcnJvclV0aWxzLmZvcm1hdChlcnJvcik7XG5cbiAgICAgIGV4cGVjdChmb3JtYXR0ZWQpLnRvQ29udGFpbignW01FRElVTV0gQlVTSU5FU1NfTE9HSUM6V0VCU0lURV9GQUlMRUQnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZWQpLnRvQ29udGFpbignV2Vic2l0ZSBmYWlsZWQnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZWQpLnRvQ29udGFpbignd2Vic2l0ZUlkPScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjb252ZXJ0IGVycm9yIHRvIGxvZyBvYmplY3QnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBGaWxlTm90Rm91bmRFcnJvcignL3Rlc3QvZmlsZS50eHQnKTtcbiAgICAgIGNvbnN0IGxvZ09iaiA9IEVycm9yVXRpbHMudG9Mb2dPYmplY3QoZXJyb3IpO1xuXG4gICAgICBleHBlY3QobG9nT2JqLm5hbWUpLnRvQmUoJ0ZpbGVOb3RGb3VuZEVycm9yJyk7XG4gICAgICBleHBlY3QobG9nT2JqLm1lc3NhZ2UpLnRvQmUoJ0ZpbGUgbm90IGZvdW5kOiAvdGVzdC9maWxlLnR4dCcpO1xuICAgICAgZXhwZWN0KGxvZ09iai5jb2RlKS50b0JlKCdGSUxFX05PVF9GT1VORCcpO1xuICAgICAgZXhwZWN0KGxvZ09iai5jYXRlZ29yeSkudG9CZShFcnJvckNhdGVnb3J5LkZJTEVfU1lTVEVNKTtcbiAgICAgIGV4cGVjdChsb2dPYmouc2V2ZXJpdHkpLnRvQmUoRXJyb3JTZXZlcml0eS5NRURJVU0pO1xuICAgICAgZXhwZWN0KGxvZ09iai5tZXRhZGF0YSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGVycm9yIHN0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvcnMgPSBbXG4gICAgICAgIG5ldyBXZWJzaXRlRXJyb3IoJ1Rlc3QgMScsICdURVNUXzEnKSxcbiAgICAgICAgbmV3IFNlcnZlckVycm9yKCdUZXN0IDInLCAnVEVTVF8yJyksXG4gICAgICAgIG5ldyBGaWxlTm90Rm91bmRFcnJvcignL2ZpbGUnKSxcbiAgICAgICAgbmV3IFdlYnNpdGVFcnJvcignVGVzdCAzJywgJ1RFU1RfMycpLFxuICAgICAgXTtcblxuICAgICAgY29uc3Qgc3RhdHMgPSBFcnJvclV0aWxzLmdldFN0YXRpc3RpY3MoZXJyb3JzKTtcblxuICAgICAgZXhwZWN0KHN0YXRzLnRvdGFsKS50b0JlKDQpO1xuICAgICAgZXhwZWN0KHN0YXRzLmJ5Q2F0ZWdvcnlbRXJyb3JDYXRlZ29yeS5CVVNJTkVTU19MT0dJQ10pLnRvQmUoMik7XG4gICAgICBleHBlY3Qoc3RhdHMuYnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LlNZU1RFTV0pLnRvQmUoMSk7XG4gICAgICBleHBlY3Qoc3RhdHMuYnlDYXRlZ29yeVtFcnJvckNhdGVnb3J5LkZJTEVfU1lTVEVNXSkudG9CZSgxKTtcbiAgICAgIGV4cGVjdChzdGF0cy5ieVNldmVyaXR5W0Vycm9yU2V2ZXJpdHkuTUVESVVNXSkudG9CZSgzKTtcbiAgICAgIGV4cGVjdChzdGF0cy5ieVNldmVyaXR5W0Vycm9yU2V2ZXJpdHkuSElHSF0pLnRvQmUoMSk7IC8vIFNlcnZlckVycm9yIGRlZmF1bHRzIHRvIEhJR0hcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ3JvdXAgZXJyb3JzIGJ5IGNhdGVnb3J5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JzID0gW1xuICAgICAgICBuZXcgV2Vic2l0ZUVycm9yKCdUZXN0IDEnLCAnVEVTVF8xJyksXG4gICAgICAgIG5ldyBTZXJ2ZXJFcnJvcignVGVzdCAyJywgJ1RFU1RfMicpLFxuICAgICAgICBuZXcgV2Vic2l0ZUVycm9yKCdUZXN0IDMnLCAnVEVTVF8zJyksXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBncm91cGVkID0gRXJyb3JVdGlscy5ncm91cEJ5Q2F0ZWdvcnkoZXJyb3JzKTtcblxuICAgICAgZXhwZWN0KGdyb3VwZWQuZ2V0KEVycm9yQ2F0ZWdvcnkuQlVTSU5FU1NfTE9HSUMpKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QoZ3JvdXBlZC5nZXQoRXJyb3JDYXRlZ29yeS5TWVNURU0pKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBDb250ZXh0IE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgIEVycm9yQ29udGV4dE1hbmFnZXIuY2xlYXJBbGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBmdW5jdGlvbiB3aXRoIGNvbnRleHQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY2FwdHVyZWRDb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuXG4gICAgICBhd2FpdCB3aXRoQ29udGV4dCh7IG9wZXJhdGlvbjogJ3Rlc3QnLCB1c2VySWQ6ICcxMjMnIH0sIGFzeW5jICgpID0+IHtcbiAgICAgICAgY2FwdHVyZWRDb250ZXh0ID0gRXJyb3JDb250ZXh0TWFuYWdlci5nZXRNZXJnZWRDb250ZXh0KCk7XG4gICAgICAgIHJldHVybiAnc3VjY2Vzcyc7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNhcHR1cmVkQ29udGV4dC5vcGVyYXRpb24pLnRvQmUoJ3Rlc3QnKTtcbiAgICAgIGV4cGVjdChjYXB0dXJlZENvbnRleHQudXNlcklkKS50b0JlKCcxMjMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5lc3RlZCBjb250ZXh0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBpbm5lckNvbnRleHQ6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG5cbiAgICAgIGF3YWl0IHdpdGhDb250ZXh0KHsgb3BlcmF0aW9uOiAnb3V0ZXInLCB1c2VySWQ6ICcxMjMnIH0sIGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgd2l0aENvbnRleHQoeyBvcGVyYXRpb246ICdpbm5lcicsIHdlYnNpdGVJZDogJ3NpdGUtNDU2JyB9LCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgaW5uZXJDb250ZXh0ID0gRXJyb3JDb250ZXh0TWFuYWdlci5nZXRNZXJnZWRDb250ZXh0KCk7XG4gICAgICAgICAgcmV0dXJuICdpbm5lcic7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gJ291dGVyJztcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoaW5uZXJDb250ZXh0Lm9wZXJhdGlvbikudG9CZSgnaW5uZXInKTsgLy8gU2hvdWxkIG92ZXJyaWRlXG4gICAgICBleHBlY3QoaW5uZXJDb250ZXh0LnVzZXJJZCkudG9CZSgnMTIzJyk7IC8vIFNob3VsZCBpbmhlcml0XG4gICAgICBleHBlY3QoaW5uZXJDb250ZXh0LndlYnNpdGVJZCkudG9CZSgnc2l0ZS00NTYnKTsgLy8gU2hvdWxkIGJlIGFkZGVkXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFuIHVwIGNvbnRleHQgc3RhY2sgcHJvcGVybHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB3aXRoQ29udGV4dCh7IG9wZXJhdGlvbjogJ3Rlc3QnIH0sIGFzeW5jICgpID0+IHtcbiAgICAgICAgZXhwZWN0KEVycm9yQ29udGV4dE1hbmFnZXIuZ2V0TWVyZ2VkQ29udGV4dCgpLm9wZXJhdGlvbikudG9CZSgndGVzdCcpO1xuICAgICAgICByZXR1cm4gJ3N1Y2Nlc3MnO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENvbnRleHQgc2hvdWxkIGJlIGNsZWFuZWQgdXBcbiAgICAgIGV4cGVjdChPYmplY3Qua2V5cyhFcnJvckNvbnRleHRNYW5hZ2VyLmdldE1lcmdlZENvbnRleHQoKSkpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIFJldHJ5IE1lY2hhbmlzbScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1Y2NlZWQgb24gZmlyc3QgdHJ5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgd2l0aFJldHJ5KFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgYXR0ZW1wdHMrKztcbiAgICAgICAgICByZXR1cm4gJ3N1Y2Nlc3MnO1xuICAgICAgICB9LFxuICAgICAgICAzLFxuICAgICAgICAxMDBcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ3N1Y2Nlc3MnKTtcbiAgICAgIGV4cGVjdChhdHRlbXB0cykudG9CZSgxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0cnkgb24gZmFpbHVyZSBhbmQgZXZlbnR1YWxseSBzdWNjZWVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGF0dGVtcHRzID0gMDtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgd2l0aFJldHJ5KFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgYXR0ZW1wdHMrKztcbiAgICAgICAgICBpZiAoYXR0ZW1wdHMgPCAzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RlbXBvcmFyeSBmYWlsdXJlJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiAnc3VjY2Vzcyc7XG4gICAgICAgIH0sXG4gICAgICAgIDMsXG4gICAgICAgIDEwXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzdWNjZXNzJyk7XG4gICAgICBleHBlY3QoYXR0ZW1wdHMpLnRvQmUoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZhaWwgYWZ0ZXIgbWF4IHJldHJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHdpdGhSZXRyeShcbiAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICBhdHRlbXB0cysrO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQZXJzaXN0ZW50IGZhaWx1cmUnKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIDIsXG4gICAgICAgICAgMTBcbiAgICAgICAgKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ1BlcnNpc3RlbnQgZmFpbHVyZScpO1xuXG4gICAgICBleHBlY3QoYXR0ZW1wdHMpLnRvQmUoMyk7IC8vIEluaXRpYWwgYXR0ZW1wdCArIDIgcmV0cmllc1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgZXJyb3Itc3BlY2lmaWMgcmV0cnkgZGVsYXlzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY2xhc3MgTmV0d29ya1Rlc3RFcnJvciBleHRlbmRzIEFuZ2xlRXJyb3Ige1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICBzdXBlcignTmV0d29yayBlcnJvcicsICdORVRXT1JLX0VSUk9SJywgRXJyb3JDYXRlZ29yeS5ORVRXT1JLKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldFJldHJ5RGVsYXkoKSB7XG4gICAgICAgICAgcmV0dXJuIDUwOyAvLyBDdXN0b20gZGVsYXlcbiAgICAgICAgfVxuXG4gICAgICAgIGlzUmVjb3ZlcmFibGUoKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7IC8vIE1ha2Ugc3VyZSBpdCdzIHJlY292ZXJhYmxlIGZvciByZXRyaWVzXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IGF0dGVtcHRzID0gMDtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHdpdGhSZXRyeShcbiAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICBhdHRlbXB0cysrO1xuICAgICAgICAgICAgdGhyb3cgbmV3IE5ldHdvcmtUZXN0RXJyb3IoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIDEsXG4gICAgICAgICAgMTAwIC8vIFRoaXMgc2hvdWxkIGJlIG92ZXJyaWRkZW4gYnkgZXJyb3IncyBnZXRSZXRyeURlbGF5KClcbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICAvLyBFeHBlY3RlZCB0byBmYWlsXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgZXhwZWN0KGF0dGVtcHRzKS50b0JlKDIpO1xuICAgICAgLy8gU2hvdWxkIGhhdmUgdXNlZCBjdXN0b20gZGVsYXkgb2YgNTBtcyBpbnN0ZWFkIG9mIDEwMG1zXG4gICAgICBleHBlY3QoZW5kVGltZSAtIHN0YXJ0VGltZSkudG9CZUxlc3NUaGFuKDgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIFJlZ2lzdHJhdGlvbiBhbmQgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgaGFuZGxlcnNcbiAgICAgIC8vIENsZWFyIGhhbmRsZXJzIC0gYWNjZXNzaW5nIHByaXZhdGUgcHJvcGVydHkgZm9yIHRlc3RpbmdcbiAgICAgIChlcnJvclJlZ2lzdHJ5IGFzIHVua25vd24gYXMgeyBoYW5kbGVyczogTWFwPHN0cmluZywgdW5rbm93bltdPiB9KS5oYW5kbGVycy5jbGVhcigpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciBhbmQgY2FsbCBlcnJvciBoYW5kbGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBqZXN0LmZuKCk7XG4gICAgICByZWdpc3RlckVycm9ySGFuZGxlcignV2Vic2l0ZUVycm9yJywgaGFuZGxlcik7XG5cbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFdlYnNpdGVFcnJvcignVGVzdCBlcnJvcicsICdURVNUJyk7XG4gICAgICBhd2FpdCBlcnJvclJlZ2lzdHJ5LmhhbmRsZUVycm9yKGVycm9yKTtcblxuICAgICAgZXhwZWN0KGhhbmRsZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsbCBnbG9iYWwgZXJyb3IgaGFuZGxlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBnbG9iYWxIYW5kbGVyID0gamVzdC5mbigpO1xuICAgICAgY29uc3Qgc3BlY2lmaWNIYW5kbGVyID0gamVzdC5mbigpO1xuXG4gICAgICByZWdpc3RlckVycm9ySGFuZGxlcignKicsIGdsb2JhbEhhbmRsZXIpO1xuICAgICAgcmVnaXN0ZXJFcnJvckhhbmRsZXIoJ1NlcnZlckVycm9yJywgc3BlY2lmaWNIYW5kbGVyKTtcblxuICAgICAgY29uc3Qgd2Vic2l0ZUVycm9yID0gbmV3IFdlYnNpdGVFcnJvcignVGVzdCcsICdURVNUJyk7XG4gICAgICBjb25zdCBzZXJ2ZXJFcnJvciA9IG5ldyBTZXJ2ZXJFcnJvcignVGVzdCcsICdURVNUJyk7XG5cbiAgICAgIGF3YWl0IGVycm9yUmVnaXN0cnkuaGFuZGxlRXJyb3Iod2Vic2l0ZUVycm9yKTtcbiAgICAgIGF3YWl0IGVycm9yUmVnaXN0cnkuaGFuZGxlRXJyb3Ioc2VydmVyRXJyb3IpO1xuXG4gICAgICBleHBlY3QoZ2xvYmFsSGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KHNwZWNpZmljSGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KHNwZWNpZmljSGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoc2VydmVyRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaGFuZGxlciBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZhdWx0eUhhbmRsZXIgPSBqZXN0LmZuKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIYW5kbGVyIGVycm9yJyk7XG4gICAgICB9KTtcblxuICAgICAgcmVnaXN0ZXJFcnJvckhhbmRsZXIoJ1dlYnNpdGVFcnJvcicsIGZhdWx0eUhhbmRsZXIpO1xuXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBXZWJzaXRlRXJyb3IoJ1Rlc3QnLCAnVEVTVCcpO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHRocm93IGRlc3BpdGUgaGFuZGxlciBlcnJvclxuICAgICAgYXdhaXQgZXhwZWN0KGVycm9yUmVnaXN0cnkuaGFuZGxlRXJyb3IoZXJyb3IpKS5yZXNvbHZlcy50b0JlVW5kZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZmF1bHR5SGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgU2VyaWFsaXphdGlvbiBhbmQgRGVzZXJpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2VyaWFsaXplIGFuZCBkZXNlcmlhbGl6ZSBlcnJvciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbEVycm9yID0gbmV3IFdlYnNpdGVOb3RGb3VuZEVycm9yKCdzaXRlLTEyMycsIHtcbiAgICAgICAgb3BlcmF0aW9uOiAnbG9hZFdlYnNpdGUnLFxuICAgICAgICBjb250ZXh0OiB7IHVzZXJJZDogJzQ1NicgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzZXJpYWxpemVkID0gb3JpZ2luYWxFcnJvci5zZXJpYWxpemUoKTtcbiAgICAgIGNvbnN0IGRlc2VyaWFsaXplZCA9IEVycm9yVXRpbHMuZnJvbVNlcmlhbGl6ZWQoc2VyaWFsaXplZCk7XG5cbiAgICAgIGV4cGVjdChkZXNlcmlhbGl6ZWQubWVzc2FnZSkudG9CZShvcmlnaW5hbEVycm9yLm1lc3NhZ2UpO1xuICAgICAgZXhwZWN0KGRlc2VyaWFsaXplZC5jb2RlKS50b0JlKG9yaWdpbmFsRXJyb3IuY29kZSk7XG4gICAgICBleHBlY3QoZGVzZXJpYWxpemVkLmNhdGVnb3J5KS50b0JlKG9yaWdpbmFsRXJyb3IuY2F0ZWdvcnkpO1xuICAgICAgZXhwZWN0KGRlc2VyaWFsaXplZC5zZXZlcml0eSkudG9CZShvcmlnaW5hbEVycm9yLnNldmVyaXR5KTtcbiAgICAgIGV4cGVjdChkZXNlcmlhbGl6ZWQubmFtZSkudG9CZShvcmlnaW5hbEVycm9yLm5hbWUpO1xuICAgICAgZXhwZWN0KGRlc2VyaWFsaXplZC5tZXRhZGF0YS5vcGVyYXRpb24pLnRvQmUoJ2xvYWRXZWJzaXRlJyk7XG4gICAgICBleHBlY3QoZGVzZXJpYWxpemVkLm1ldGFkYXRhLmNvbnRleHQ/LnVzZXJJZCkudG9CZSgnNDU2Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXN0ZWQgZXJyb3Igc2VyaWFsaXphdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGNhdXNlID0gbmV3IEVycm9yKCdSb290IGNhdXNlJyk7XG4gICAgICBjb25zdCB3cmFwcGVkQ2F1c2UgPSBFcnJvclV0aWxzLndyYXAoY2F1c2UpO1xuICAgICAgY29uc3QgdG9wRXJyb3IgPSBuZXcgV2Vic2l0ZUVycm9yKFxuICAgICAgICAnVG9wIGxldmVsJyxcbiAgICAgICAgJ1RPUF9MRVZFTCcsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgd3JhcHBlZENhdXNlXG4gICAgICApO1xuXG4gICAgICBjb25zdCBzZXJpYWxpemVkID0gdG9wRXJyb3Iuc2VyaWFsaXplKCk7XG4gICAgICBleHBlY3Qoc2VyaWFsaXplZC5jYXVzZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzZXJpYWxpemVkLmNhdXNlPy5tZXNzYWdlKS50b0JlKCdSb290IGNhdXNlJyk7XG5cbiAgICAgIGNvbnN0IGRlc2VyaWFsaXplZCA9IEVycm9yVXRpbHMuZnJvbVNlcmlhbGl6ZWQoc2VyaWFsaXplZCk7XG4gICAgICBleHBlY3QoZGVzZXJpYWxpemVkLmdldFJvb3RDYXVzZSgpLm1lc3NhZ2UpLnRvQmUoJ1Jvb3QgY2F1c2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY29udmVydCB0byBKU09OIHByb3Blcmx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgU2VydmVyU3RhcnRFcnJvcigzMDAwLCAnUG9ydCBpbiB1c2UnKTtcbiAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShlcnJvcik7XG4gICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuXG4gICAgICBleHBlY3QocGFyc2VkLm5hbWUpLnRvQmUoJ1NlcnZlclN0YXJ0RXJyb3InKTtcbiAgICAgIGV4cGVjdChwYXJzZWQubWVzc2FnZSkudG9CZSgnRmFpbGVkIHRvIHN0YXJ0IHNlcnZlciBvbiBwb3J0IDMwMDA6IFBvcnQgaW4gdXNlJyk7XG4gICAgICBleHBlY3QocGFyc2VkLmNvZGUpLnRvQmUoJ1NFUlZFUl9TVEFSVF9GQUlMRUQnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==