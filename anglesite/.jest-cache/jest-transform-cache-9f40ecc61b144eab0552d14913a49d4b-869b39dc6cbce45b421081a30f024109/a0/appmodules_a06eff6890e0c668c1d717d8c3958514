bb26bbeb365f6881350bb45a150d6ad0
"use strict";
// test/mocks/app-modules.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.mockTemplateLoader = exports.mockWebsiteManager = exports.mockThemeManager = exports.mockHostsManager = exports.mockHttpsProxy = exports.mockEleventy = exports.mockFirstLaunch = exports.mockStoreInstance = exports.mockIpcHandlers = exports.mockAppMenu = exports.mockMultiWindowManager = exports.mockWindowManager = exports.resetAppModulesMocks = void 0;
jest.mock('../../app/ui/window-manager', () => mockWindowManager);
jest.mock('../../app/ui/multi-window-manager', () => mockMultiWindowManager);
jest.mock('../../app/ui/menu', () => mockAppMenu);
// Mock individual IPC modules
jest.mock('../../app/ipc/website', () => ({
    setupWebsiteHandlers: jest.fn(),
}));
jest.mock('../../app/ipc/file', () => ({
    setupFileHandlers: jest.fn(),
}));
jest.mock('../../app/ipc/preview', () => ({
    setupPreviewHandlers: jest.fn(),
}));
jest.mock('../../app/ipc/export', () => ({
    setupExportHandlers: jest.fn(),
}));
jest.mock('../../app/ipc/handlers', () => mockIpcHandlers);
// Store class removed - now using DI with StoreService
// Mock the service registry to provide mocked services
jest.mock('../../app/core/service-registry', () => ({
    initializeGlobalContext: jest.fn(() => Promise.resolve()),
    getGlobalContext: () => ({
        getService: (key) => {
            if (key === 'store') {
                return mockStoreInstance;
            }
            throw new Error(`Unknown service: ${key}`);
        },
    }),
    shutdownGlobalContext: jest.fn(() => Promise.resolve()),
}));
jest.mock('../../app/utils/first-launch', () => mockFirstLaunch);
jest.mock('../../app/server/eleventy', () => mockEleventy);
jest.mock('../../app/server/https-proxy', () => mockHttpsProxy);
jest.mock('../../app/dns/hosts-manager', () => mockHostsManager);
jest.mock('../../app/ui/theme-manager', () => ({ themeManager: mockThemeManager }));
jest.mock('../../app/utils/website-manager', () => mockWebsiteManager);
jest.mock('../../app/ui/template-loader', () => mockTemplateLoader);
// Mock UI modules
const mockWindowManager = {
    showPreview: jest.fn(),
    hidePreview: jest.fn(),
    reloadPreview: jest.fn(),
    togglePreviewDevTools: jest.fn(),
    getNativeInput: jest.fn(),
    getBagItMetadata: jest.fn(),
};
exports.mockWindowManager = mockWindowManager;
const mockMultiWindowManager = {
    closeAllWindows: jest.fn(),
    restoreWindowStates: jest.fn(),
    getAllWebsiteWindows: jest.fn(() => new Map()),
    createWebsiteWindow: jest.fn((_websiteName, _websitePath) => ({})), // Return mock object
    loadWebsiteContent: jest.fn((_websiteName) => { }),
    getWebsiteWindow: jest.fn((_websiteName) => null),
    saveWindowStates: jest.fn(),
    setupServerManagerEventListeners: jest.fn(),
};
exports.mockMultiWindowManager = mockMultiWindowManager;
const mockAppMenu = {
    createApplicationMenu: jest.fn(),
    updateApplicationMenu: jest.fn(),
};
exports.mockAppMenu = mockAppMenu;
// Mock IPC handlers module
const mockIpcHandlers = {
    setupIpcMainListeners: jest.fn(),
};
exports.mockIpcHandlers = mockIpcHandlers;
const mockStoreInstance = {
    get: jest.fn(),
    set: jest.fn(),
    saveWindowStates: jest.fn(),
    getWindowStates: jest.fn(() => []), // Default for multi-window-manager
    clearWindowStates: jest.fn(),
    getAll: jest.fn(() => ({})),
    setAll: jest.fn(),
    forceSave: jest.fn(() => Promise.resolve()),
};
exports.mockStoreInstance = mockStoreInstance;
const mockFirstLaunch = {
    handleFirstLaunch: jest.fn(),
};
exports.mockFirstLaunch = mockFirstLaunch;
const mockEleventy = {
    getCurrentLiveServerUrl: jest.fn(() => 'https://anglesite.test:8080'), // Default for multi-window-manager
    isLiveServerReady: jest.fn(() => true),
    setLiveServerUrl: jest.fn(),
    setCurrentWebsiteName: jest.fn(),
};
exports.mockEleventy = mockEleventy;
const mockHttpsProxy = {
    createHttpsProxy: jest.fn(),
    restartHttpsProxy: jest.fn(),
};
exports.mockHttpsProxy = mockHttpsProxy;
const mockHostsManager = {
    addLocalDnsResolution: jest.fn(),
    cleanupHostsFile: jest.fn(),
    checkAndSuggestTouchIdSetup: jest.fn(),
};
exports.mockHostsManager = mockHostsManager;
const mockThemeManager = {
    initialize: jest.fn(),
    applyThemeToWindow: jest.fn(),
};
exports.mockThemeManager = mockThemeManager;
const mockWebsiteManager = {
    createWebsiteWithName: jest.fn(),
    validateWebsiteName: jest.fn(),
    listWebsites: jest.fn(() => ['test-site', 'my-website']),
    getWebsitePath: jest.fn(),
    renameWebsite: jest.fn(),
    deleteWebsite: jest.fn(),
};
exports.mockWebsiteManager = mockWebsiteManager;
const mockTemplateLoader = {
    loadTemplateAsDataUrl: jest.fn((templateName) => {
        return `data:text/html;charset=utf-8,<h1>Mock ${templateName}</h1>`;
    }),
};
exports.mockTemplateLoader = mockTemplateLoader;
// Path is already mocked by node-modules.ts
const resetAppModulesMocks = () => {
    mockWindowManager.showPreview.mockClear();
    mockWindowManager.hidePreview.mockClear();
    mockWindowManager.reloadPreview.mockClear();
    mockWindowManager.togglePreviewDevTools.mockClear();
    mockWindowManager.getNativeInput.mockClear();
    mockWindowManager.getBagItMetadata.mockClear();
    mockMultiWindowManager.closeAllWindows.mockClear();
    mockMultiWindowManager.restoreWindowStates.mockClear();
    mockMultiWindowManager.getAllWebsiteWindows.mockClear();
    mockMultiWindowManager.getAllWebsiteWindows.mockReturnValue(new Map()); // Restore implementation
    mockMultiWindowManager.createWebsiteWindow.mockClear();
    mockMultiWindowManager.createWebsiteWindow.mockImplementation((_websiteName, _websitePath) => ({})); // Restore implementation
    mockMultiWindowManager.loadWebsiteContent.mockClear();
    mockMultiWindowManager.loadWebsiteContent.mockImplementation((_websiteName) => { }); // Restore implementation
    mockMultiWindowManager.getWebsiteWindow.mockClear();
    mockMultiWindowManager.getWebsiteWindow.mockImplementation((_websiteName) => null); // Restore implementation
    mockMultiWindowManager.saveWindowStates.mockClear();
    mockAppMenu.createApplicationMenu.mockClear();
    mockAppMenu.updateApplicationMenu.mockClear();
    mockIpcHandlers.setupIpcMainListeners.mockClear();
    // Store mock instance needs special handling to preserve implementation
    const getImpl = mockStoreInstance.get.getMockImplementation();
    const setImpl = mockStoreInstance.set.getMockImplementation();
    const saveWindowStatesImpl = mockStoreInstance.saveWindowStates.getMockImplementation();
    const getWindowStatesImpl = mockStoreInstance.getWindowStates.getMockImplementation();
    const clearWindowStatesImpl = mockStoreInstance.clearWindowStates.getMockImplementation();
    const getAllImpl = mockStoreInstance.getAll.getMockImplementation();
    const setAllImpl = mockStoreInstance.setAll.getMockImplementation();
    const forceSaveImpl = mockStoreInstance.forceSave.getMockImplementation();
    mockStoreInstance.get.mockClear();
    mockStoreInstance.set.mockClear();
    mockStoreInstance.saveWindowStates.mockClear();
    mockStoreInstance.getWindowStates.mockClear();
    mockStoreInstance.clearWindowStates.mockClear();
    mockStoreInstance.getAll.mockClear();
    mockStoreInstance.setAll.mockClear();
    mockStoreInstance.forceSave.mockClear();
    if (getImpl)
        mockStoreInstance.get.mockImplementation(getImpl);
    if (setImpl)
        mockStoreInstance.set.mockImplementation(setImpl);
    if (saveWindowStatesImpl)
        mockStoreInstance.saveWindowStates.mockImplementation(saveWindowStatesImpl);
    if (getWindowStatesImpl)
        mockStoreInstance.getWindowStates.mockImplementation(getWindowStatesImpl);
    if (clearWindowStatesImpl)
        mockStoreInstance.clearWindowStates.mockImplementation(clearWindowStatesImpl);
    if (getAllImpl)
        mockStoreInstance.getAll.mockImplementation(getAllImpl);
    if (setAllImpl)
        mockStoreInstance.setAll.mockImplementation(setAllImpl);
    if (forceSaveImpl)
        mockStoreInstance.forceSave.mockImplementation(forceSaveImpl);
    mockFirstLaunch.handleFirstLaunch.mockClear();
    mockEleventy.getCurrentLiveServerUrl.mockClear();
    mockEleventy.isLiveServerReady.mockClear();
    mockEleventy.setLiveServerUrl.mockClear();
    mockEleventy.setCurrentWebsiteName.mockClear();
    mockHttpsProxy.createHttpsProxy.mockClear();
    mockHttpsProxy.restartHttpsProxy.mockClear();
    mockHostsManager.addLocalDnsResolution.mockClear();
    mockHostsManager.cleanupHostsFile.mockClear();
    mockHostsManager.checkAndSuggestTouchIdSetup.mockClear();
    mockThemeManager.initialize.mockClear();
    mockThemeManager.applyThemeToWindow.mockClear();
    mockWebsiteManager.createWebsiteWithName.mockClear();
    mockWebsiteManager.validateWebsiteName.mockClear();
    mockWebsiteManager.listWebsites.mockClear();
    mockWebsiteManager.getWebsitePath.mockClear();
    mockWebsiteManager.renameWebsite.mockClear();
    mockWebsiteManager.deleteWebsite.mockClear();
    mockTemplateLoader.loadTemplateAsDataUrl.mockClear();
};
exports.resetAppModulesMocks = resetAppModulesMocks;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2R3ay9EZXZlbG9wZXIvZ2l0bGFiLmNvbS9kYXZpZHdrZWl0aC9AZHdrL2FuZ2xlc2l0ZS90ZXN0L21vY2tzL2FwcC1tb2R1bGVzLnRzIiwibWFwcGluZ3MiOiI7QUFBQSw0QkFBNEI7OztBQVk1QixJQUFJLENBQUMsSUFBSSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRSxDQUFDLGlCQUFpQixDQUFDLENBQUM7QUFhbEUsSUFBSSxDQUFDLElBQUksQ0FBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBTzdFLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUM7QUFFbEQsOEJBQThCO0FBQzlCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN4QyxvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ2hDLENBQUMsQ0FBQyxDQUFDO0FBRUosSUFBSSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3JDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDN0IsQ0FBQyxDQUFDLENBQUM7QUFFSixJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDeEMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNoQyxDQUFDLENBQUMsQ0FBQztBQUVKLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN2QyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQy9CLENBQUMsQ0FBQyxDQUFDO0FBT0osSUFBSSxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQztBQWEzRCx1REFBdUQ7QUFFdkQsdURBQXVEO0FBQ3ZELElBQUksQ0FBQyxJQUFJLENBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsRCx1QkFBdUIsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUN6RCxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZCLFVBQVUsRUFBRSxDQUFDLEdBQVcsRUFBRSxFQUFFO1lBQzFCLElBQUksR0FBRyxLQUFLLE9BQU8sRUFBRSxDQUFDO2dCQUNwQixPQUFPLGlCQUFpQixDQUFDO1lBQzNCLENBQUM7WUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLG9CQUFvQixHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQzdDLENBQUM7S0FDRixDQUFDO0lBQ0YscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7Q0FDeEQsQ0FBQyxDQUFDLENBQUM7QUFNSixJQUFJLENBQUMsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBU2pFLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUM7QUFPM0QsSUFBSSxDQUFDLElBQUksQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQVFoRSxJQUFJLENBQUMsSUFBSSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFPakUsSUFBSSxDQUFDLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDO0FBV3BGLElBQUksQ0FBQyxJQUFJLENBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQVF2RSxJQUFJLENBQUMsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRSxDQUFDLGtCQUFrQixDQUFDLENBQUM7QUF6SXBFLGtCQUFrQjtBQUNsQixNQUFNLGlCQUFpQixHQUFHO0lBQ3hCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3RCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3RCLGFBQWEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3hCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDaEMsY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDekIsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUM1QixDQUFDO0FBc05BLDhDQUFpQjtBQWxObkIsTUFBTSxzQkFBc0IsR0FBRztJQUM3QixlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUMxQixtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzlCLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUM5QyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsWUFBb0IsRUFBRSxZQUFxQixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUscUJBQXFCO0lBQzFHLGtCQUFrQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxZQUFvQixFQUFFLEVBQUUsR0FBRSxDQUFDLENBQUM7SUFDekQsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFlBQW9CLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQztJQUN6RCxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzNCLGdDQUFnQyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDNUMsQ0FBQztBQTBNQSx3REFBc0I7QUF0TXhCLE1BQU0sV0FBVyxHQUFHO0lBQ2xCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDaEMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNqQyxDQUFDO0FBb01BLGtDQUFXO0FBL0tiLDJCQUEyQjtBQUMzQixNQUFNLGVBQWUsR0FBRztJQUN0QixxQkFBcUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ2pDLENBQUM7QUE2S0EsMENBQWU7QUF6S2pCLE1BQU0saUJBQWlCLEdBQUc7SUFDeEIsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZCxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNkLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDM0IsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBZSxDQUFDLEVBQUUsbUNBQW1DO0lBQ3BGLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDNUIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMzQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNqQixTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7Q0FDNUMsQ0FBQztBQWlLQSw4Q0FBaUI7QUEvSW5CLE1BQU0sZUFBZSxHQUFHO0lBQ3RCLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDN0IsQ0FBQztBQThJQSwwQ0FBZTtBQTFJakIsTUFBTSxZQUFZLEdBQUc7SUFDbkIsdUJBQXVCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyw2QkFBNkIsQ0FBQyxFQUFFLG1DQUFtQztJQUMxRyxpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQztJQUN0QyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzNCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDakMsQ0FBQztBQXNJQSxvQ0FBWTtBQWxJZCxNQUFNLGNBQWMsR0FBRztJQUNyQixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzNCLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDN0IsQ0FBQztBQWdJQSx3Q0FBYztBQTVIaEIsTUFBTSxnQkFBZ0IsR0FBRztJQUN2QixxQkFBcUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDM0IsMkJBQTJCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN2QyxDQUFDO0FBeUhBLDRDQUFnQjtBQXJIbEIsTUFBTSxnQkFBZ0IsR0FBRztJQUN2QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNyQixrQkFBa0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQzlCLENBQUM7QUFtSEEsNENBQWdCO0FBL0dsQixNQUFNLGtCQUFrQixHQUFHO0lBQ3pCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDaEMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM5QixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUN4RCxjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN6QixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN4QixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN6QixDQUFDO0FBeUdBLGdEQUFrQjtBQXJHcEIsTUFBTSxrQkFBa0IsR0FBRztJQUN6QixxQkFBcUIsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsWUFBb0IsRUFBRSxFQUFFO1FBQ3RELE9BQU8seUNBQXlDLFlBQVksT0FBTyxDQUFDO0lBQ3RFLENBQUMsQ0FBQztDQUNILENBQUM7QUFrR0EsZ0RBQWtCO0FBOUZwQiw0Q0FBNEM7QUFFckMsTUFBTSxvQkFBb0IsR0FBRyxHQUFHLEVBQUU7SUFDdkMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMxQyxpQkFBaUIsQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDNUMsaUJBQWlCLENBQUMscUJBQXFCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDcEQsaUJBQWlCLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzdDLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRS9DLHNCQUFzQixDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNuRCxzQkFBc0IsQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN2RCxzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN4RCxzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQyxlQUFlLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMseUJBQXlCO0lBQ2pHLHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3ZELHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLGtCQUFrQixDQUFDLENBQUMsWUFBb0IsRUFBRSxZQUFxQixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyx5QkFBeUI7SUFDL0ksc0JBQXNCLENBQUMsa0JBQWtCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDdEQsc0JBQXNCLENBQUMsa0JBQWtCLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxZQUFvQixFQUFFLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLHlCQUF5QjtJQUNySCxzQkFBc0IsQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNwRCxzQkFBc0IsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFlBQW9CLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMseUJBQXlCO0lBQ3JILHNCQUFzQixDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRXBELFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUM5QyxXQUFXLENBQUMscUJBQXFCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFFOUMsZUFBZSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRWxELHdFQUF3RTtJQUN4RSxNQUFNLE9BQU8sR0FBRyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUM5RCxNQUFNLE9BQU8sR0FBRyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUM5RCxNQUFNLG9CQUFvQixHQUFHLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDeEYsTUFBTSxtQkFBbUIsR0FBRyxpQkFBaUIsQ0FBQyxlQUFlLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUN0RixNQUFNLHFCQUFxQixHQUFHLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDMUYsTUFBTSxVQUFVLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDcEUsTUFBTSxVQUFVLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDcEUsTUFBTSxhQUFhLEdBQUcsaUJBQWlCLENBQUMsU0FBUyxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFFMUUsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ2xDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNsQyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMvQyxpQkFBaUIsQ0FBQyxlQUFlLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDOUMsaUJBQWlCLENBQUMsaUJBQWlCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDaEQsaUJBQWlCLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3JDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNyQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLENBQUM7SUFFeEMsSUFBSSxPQUFPO1FBQUUsaUJBQWlCLENBQUMsR0FBRyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQy9ELElBQUksT0FBTztRQUFFLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMvRCxJQUFJLG9CQUFvQjtRQUFFLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLGtCQUFrQixDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDdEcsSUFBSSxtQkFBbUI7UUFBRSxpQkFBaUIsQ0FBQyxlQUFlLENBQUMsa0JBQWtCLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUNuRyxJQUFJLHFCQUFxQjtRQUFFLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLHFCQUFxQixDQUFDLENBQUM7SUFDekcsSUFBSSxVQUFVO1FBQUUsaUJBQWlCLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3hFLElBQUksVUFBVTtRQUFFLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4RSxJQUFJLGFBQWE7UUFBRSxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsYUFBYSxDQUFDLENBQUM7SUFFakYsZUFBZSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRTlDLFlBQVksQ0FBQyx1QkFBdUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNqRCxZQUFZLENBQUMsaUJBQWlCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDM0MsWUFBWSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzFDLFlBQVksQ0FBQyxxQkFBcUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUUvQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDNUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRTdDLGdCQUFnQixDQUFDLHFCQUFxQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ25ELGdCQUFnQixDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzlDLGdCQUFnQixDQUFDLDJCQUEyQixDQUFDLFNBQVMsRUFBRSxDQUFDO0lBRXpELGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN4QyxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUVoRCxrQkFBa0IsQ0FBQyxxQkFBcUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNyRCxrQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNuRCxrQkFBa0IsQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDNUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzlDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUM3QyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7SUFFN0Msa0JBQWtCLENBQUMscUJBQXFCLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDdkQsQ0FBQyxDQUFDO0FBOUVXLFFBQUEsb0JBQW9CLHdCQThFL0IiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2R3ay9EZXZlbG9wZXIvZ2l0bGFiLmNvbS9kYXZpZHdrZWl0aC9AZHdrL2FuZ2xlc2l0ZS90ZXN0L21vY2tzL2FwcC1tb2R1bGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHRlc3QvbW9ja3MvYXBwLW1vZHVsZXMudHNcblxuLy8gTW9jayBVSSBtb2R1bGVzXG5jb25zdCBtb2NrV2luZG93TWFuYWdlciA9IHtcbiAgc2hvd1ByZXZpZXc6IGplc3QuZm4oKSxcbiAgaGlkZVByZXZpZXc6IGplc3QuZm4oKSxcbiAgcmVsb2FkUHJldmlldzogamVzdC5mbigpLFxuICB0b2dnbGVQcmV2aWV3RGV2VG9vbHM6IGplc3QuZm4oKSxcbiAgZ2V0TmF0aXZlSW5wdXQ6IGplc3QuZm4oKSxcbiAgZ2V0QmFnSXRNZXRhZGF0YTogamVzdC5mbigpLFxufTtcblxuamVzdC5tb2NrKCcuLi8uLi9hcHAvdWkvd2luZG93LW1hbmFnZXInLCAoKSA9PiBtb2NrV2luZG93TWFuYWdlcik7XG5cbmNvbnN0IG1vY2tNdWx0aVdpbmRvd01hbmFnZXIgPSB7XG4gIGNsb3NlQWxsV2luZG93czogamVzdC5mbigpLFxuICByZXN0b3JlV2luZG93U3RhdGVzOiBqZXN0LmZuKCksXG4gIGdldEFsbFdlYnNpdGVXaW5kb3dzOiBqZXN0LmZuKCgpID0+IG5ldyBNYXAoKSksXG4gIGNyZWF0ZVdlYnNpdGVXaW5kb3c6IGplc3QuZm4oKF93ZWJzaXRlTmFtZTogc3RyaW5nLCBfd2Vic2l0ZVBhdGg/OiBzdHJpbmcpID0+ICh7fSkpLCAvLyBSZXR1cm4gbW9jayBvYmplY3RcbiAgbG9hZFdlYnNpdGVDb250ZW50OiBqZXN0LmZuKChfd2Vic2l0ZU5hbWU6IHN0cmluZykgPT4ge30pLFxuICBnZXRXZWJzaXRlV2luZG93OiBqZXN0LmZuKChfd2Vic2l0ZU5hbWU6IHN0cmluZykgPT4gbnVsbCksXG4gIHNhdmVXaW5kb3dTdGF0ZXM6IGplc3QuZm4oKSxcbiAgc2V0dXBTZXJ2ZXJNYW5hZ2VyRXZlbnRMaXN0ZW5lcnM6IGplc3QuZm4oKSxcbn07XG5cbmplc3QubW9jaygnLi4vLi4vYXBwL3VpL211bHRpLXdpbmRvdy1tYW5hZ2VyJywgKCkgPT4gbW9ja011bHRpV2luZG93TWFuYWdlcik7XG5cbmNvbnN0IG1vY2tBcHBNZW51ID0ge1xuICBjcmVhdGVBcHBsaWNhdGlvbk1lbnU6IGplc3QuZm4oKSxcbiAgdXBkYXRlQXBwbGljYXRpb25NZW51OiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC91aS9tZW51JywgKCkgPT4gbW9ja0FwcE1lbnUpO1xuXG4vLyBNb2NrIGluZGl2aWR1YWwgSVBDIG1vZHVsZXNcbmplc3QubW9jaygnLi4vLi4vYXBwL2lwYy93ZWJzaXRlJywgKCkgPT4gKHtcbiAgc2V0dXBXZWJzaXRlSGFuZGxlcnM6IGplc3QuZm4oKSxcbn0pKTtcblxuamVzdC5tb2NrKCcuLi8uLi9hcHAvaXBjL2ZpbGUnLCAoKSA9PiAoe1xuICBzZXR1cEZpbGVIYW5kbGVyczogamVzdC5mbigpLFxufSkpO1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC9pcGMvcHJldmlldycsICgpID0+ICh7XG4gIHNldHVwUHJldmlld0hhbmRsZXJzOiBqZXN0LmZuKCksXG59KSk7XG5cbmplc3QubW9jaygnLi4vLi4vYXBwL2lwYy9leHBvcnQnLCAoKSA9PiAoe1xuICBzZXR1cEV4cG9ydEhhbmRsZXJzOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgSVBDIGhhbmRsZXJzIG1vZHVsZVxuY29uc3QgbW9ja0lwY0hhbmRsZXJzID0ge1xuICBzZXR1cElwY01haW5MaXN0ZW5lcnM6IGplc3QuZm4oKSxcbn07XG5cbmplc3QubW9jaygnLi4vLi4vYXBwL2lwYy9oYW5kbGVycycsICgpID0+IG1vY2tJcGNIYW5kbGVycyk7XG5cbmNvbnN0IG1vY2tTdG9yZUluc3RhbmNlID0ge1xuICBnZXQ6IGplc3QuZm4oKSxcbiAgc2V0OiBqZXN0LmZuKCksXG4gIHNhdmVXaW5kb3dTdGF0ZXM6IGplc3QuZm4oKSxcbiAgZ2V0V2luZG93U3RhdGVzOiBqZXN0LmZuKCgpID0+IFtdIGFzIHVua25vd25bXSksIC8vIERlZmF1bHQgZm9yIG11bHRpLXdpbmRvdy1tYW5hZ2VyXG4gIGNsZWFyV2luZG93U3RhdGVzOiBqZXN0LmZuKCksXG4gIGdldEFsbDogamVzdC5mbigoKSA9PiAoe30pKSxcbiAgc2V0QWxsOiBqZXN0LmZuKCksXG4gIGZvcmNlU2F2ZTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoKSksXG59O1xuXG4vLyBTdG9yZSBjbGFzcyByZW1vdmVkIC0gbm93IHVzaW5nIERJIHdpdGggU3RvcmVTZXJ2aWNlXG5cbi8vIE1vY2sgdGhlIHNlcnZpY2UgcmVnaXN0cnkgdG8gcHJvdmlkZSBtb2NrZWQgc2VydmljZXNcbmplc3QubW9jaygnLi4vLi4vYXBwL2NvcmUvc2VydmljZS1yZWdpc3RyeScsICgpID0+ICh7XG4gIGluaXRpYWxpemVHbG9iYWxDb250ZXh0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKSxcbiAgZ2V0R2xvYmFsQ29udGV4dDogKCkgPT4gKHtcbiAgICBnZXRTZXJ2aWNlOiAoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChrZXkgPT09ICdzdG9yZScpIHtcbiAgICAgICAgcmV0dXJuIG1vY2tTdG9yZUluc3RhbmNlO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHNlcnZpY2U6ICR7a2V5fWApO1xuICAgIH0sXG4gIH0pLFxuICBzaHV0ZG93bkdsb2JhbENvbnRleHQ6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCkpLFxufSkpO1xuXG5jb25zdCBtb2NrRmlyc3RMYXVuY2ggPSB7XG4gIGhhbmRsZUZpcnN0TGF1bmNoOiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC91dGlscy9maXJzdC1sYXVuY2gnLCAoKSA9PiBtb2NrRmlyc3RMYXVuY2gpO1xuXG5jb25zdCBtb2NrRWxldmVudHkgPSB7XG4gIGdldEN1cnJlbnRMaXZlU2VydmVyVXJsOiBqZXN0LmZuKCgpID0+ICdodHRwczovL2FuZ2xlc2l0ZS50ZXN0OjgwODAnKSwgLy8gRGVmYXVsdCBmb3IgbXVsdGktd2luZG93LW1hbmFnZXJcbiAgaXNMaXZlU2VydmVyUmVhZHk6IGplc3QuZm4oKCkgPT4gdHJ1ZSksXG4gIHNldExpdmVTZXJ2ZXJVcmw6IGplc3QuZm4oKSxcbiAgc2V0Q3VycmVudFdlYnNpdGVOYW1lOiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC9zZXJ2ZXIvZWxldmVudHknLCAoKSA9PiBtb2NrRWxldmVudHkpO1xuXG5jb25zdCBtb2NrSHR0cHNQcm94eSA9IHtcbiAgY3JlYXRlSHR0cHNQcm94eTogamVzdC5mbigpLFxuICByZXN0YXJ0SHR0cHNQcm94eTogamVzdC5mbigpLFxufTtcblxuamVzdC5tb2NrKCcuLi8uLi9hcHAvc2VydmVyL2h0dHBzLXByb3h5JywgKCkgPT4gbW9ja0h0dHBzUHJveHkpO1xuXG5jb25zdCBtb2NrSG9zdHNNYW5hZ2VyID0ge1xuICBhZGRMb2NhbERuc1Jlc29sdXRpb246IGplc3QuZm4oKSxcbiAgY2xlYW51cEhvc3RzRmlsZTogamVzdC5mbigpLFxuICBjaGVja0FuZFN1Z2dlc3RUb3VjaElkU2V0dXA6IGplc3QuZm4oKSxcbn07XG5cbmplc3QubW9jaygnLi4vLi4vYXBwL2Rucy9ob3N0cy1tYW5hZ2VyJywgKCkgPT4gbW9ja0hvc3RzTWFuYWdlcik7XG5cbmNvbnN0IG1vY2tUaGVtZU1hbmFnZXIgPSB7XG4gIGluaXRpYWxpemU6IGplc3QuZm4oKSxcbiAgYXBwbHlUaGVtZVRvV2luZG93OiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC91aS90aGVtZS1tYW5hZ2VyJywgKCkgPT4gKHsgdGhlbWVNYW5hZ2VyOiBtb2NrVGhlbWVNYW5hZ2VyIH0pKTtcblxuY29uc3QgbW9ja1dlYnNpdGVNYW5hZ2VyID0ge1xuICBjcmVhdGVXZWJzaXRlV2l0aE5hbWU6IGplc3QuZm4oKSxcbiAgdmFsaWRhdGVXZWJzaXRlTmFtZTogamVzdC5mbigpLFxuICBsaXN0V2Vic2l0ZXM6IGplc3QuZm4oKCkgPT4gWyd0ZXN0LXNpdGUnLCAnbXktd2Vic2l0ZSddKSxcbiAgZ2V0V2Vic2l0ZVBhdGg6IGplc3QuZm4oKSxcbiAgcmVuYW1lV2Vic2l0ZTogamVzdC5mbigpLFxuICBkZWxldGVXZWJzaXRlOiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJy4uLy4uL2FwcC91dGlscy93ZWJzaXRlLW1hbmFnZXInLCAoKSA9PiBtb2NrV2Vic2l0ZU1hbmFnZXIpO1xuXG5jb25zdCBtb2NrVGVtcGxhdGVMb2FkZXIgPSB7XG4gIGxvYWRUZW1wbGF0ZUFzRGF0YVVybDogamVzdC5mbigodGVtcGxhdGVOYW1lOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gYGRhdGE6dGV4dC9odG1sO2NoYXJzZXQ9dXRmLTgsPGgxPk1vY2sgJHt0ZW1wbGF0ZU5hbWV9PC9oMT5gO1xuICB9KSxcbn07XG5cbmplc3QubW9jaygnLi4vLi4vYXBwL3VpL3RlbXBsYXRlLWxvYWRlcicsICgpID0+IG1vY2tUZW1wbGF0ZUxvYWRlcik7XG5cbi8vIFBhdGggaXMgYWxyZWFkeSBtb2NrZWQgYnkgbm9kZS1tb2R1bGVzLnRzXG5cbmV4cG9ydCBjb25zdCByZXNldEFwcE1vZHVsZXNNb2NrcyA9ICgpID0+IHtcbiAgbW9ja1dpbmRvd01hbmFnZXIuc2hvd1ByZXZpZXcubW9ja0NsZWFyKCk7XG4gIG1vY2tXaW5kb3dNYW5hZ2VyLmhpZGVQcmV2aWV3Lm1vY2tDbGVhcigpO1xuICBtb2NrV2luZG93TWFuYWdlci5yZWxvYWRQcmV2aWV3Lm1vY2tDbGVhcigpO1xuICBtb2NrV2luZG93TWFuYWdlci50b2dnbGVQcmV2aWV3RGV2VG9vbHMubW9ja0NsZWFyKCk7XG4gIG1vY2tXaW5kb3dNYW5hZ2VyLmdldE5hdGl2ZUlucHV0Lm1vY2tDbGVhcigpO1xuICBtb2NrV2luZG93TWFuYWdlci5nZXRCYWdJdE1ldGFkYXRhLm1vY2tDbGVhcigpO1xuXG4gIG1vY2tNdWx0aVdpbmRvd01hbmFnZXIuY2xvc2VBbGxXaW5kb3dzLm1vY2tDbGVhcigpO1xuICBtb2NrTXVsdGlXaW5kb3dNYW5hZ2VyLnJlc3RvcmVXaW5kb3dTdGF0ZXMubW9ja0NsZWFyKCk7XG4gIG1vY2tNdWx0aVdpbmRvd01hbmFnZXIuZ2V0QWxsV2Vic2l0ZVdpbmRvd3MubW9ja0NsZWFyKCk7XG4gIG1vY2tNdWx0aVdpbmRvd01hbmFnZXIuZ2V0QWxsV2Vic2l0ZVdpbmRvd3MubW9ja1JldHVyblZhbHVlKG5ldyBNYXAoKSk7IC8vIFJlc3RvcmUgaW1wbGVtZW50YXRpb25cbiAgbW9ja011bHRpV2luZG93TWFuYWdlci5jcmVhdGVXZWJzaXRlV2luZG93Lm1vY2tDbGVhcigpO1xuICBtb2NrTXVsdGlXaW5kb3dNYW5hZ2VyLmNyZWF0ZVdlYnNpdGVXaW5kb3cubW9ja0ltcGxlbWVudGF0aW9uKChfd2Vic2l0ZU5hbWU6IHN0cmluZywgX3dlYnNpdGVQYXRoPzogc3RyaW5nKSA9PiAoe30pKTsgLy8gUmVzdG9yZSBpbXBsZW1lbnRhdGlvblxuICBtb2NrTXVsdGlXaW5kb3dNYW5hZ2VyLmxvYWRXZWJzaXRlQ29udGVudC5tb2NrQ2xlYXIoKTtcbiAgbW9ja011bHRpV2luZG93TWFuYWdlci5sb2FkV2Vic2l0ZUNvbnRlbnQubW9ja0ltcGxlbWVudGF0aW9uKChfd2Vic2l0ZU5hbWU6IHN0cmluZykgPT4ge30pOyAvLyBSZXN0b3JlIGltcGxlbWVudGF0aW9uXG4gIG1vY2tNdWx0aVdpbmRvd01hbmFnZXIuZ2V0V2Vic2l0ZVdpbmRvdy5tb2NrQ2xlYXIoKTtcbiAgbW9ja011bHRpV2luZG93TWFuYWdlci5nZXRXZWJzaXRlV2luZG93Lm1vY2tJbXBsZW1lbnRhdGlvbigoX3dlYnNpdGVOYW1lOiBzdHJpbmcpID0+IG51bGwpOyAvLyBSZXN0b3JlIGltcGxlbWVudGF0aW9uXG4gIG1vY2tNdWx0aVdpbmRvd01hbmFnZXIuc2F2ZVdpbmRvd1N0YXRlcy5tb2NrQ2xlYXIoKTtcblxuICBtb2NrQXBwTWVudS5jcmVhdGVBcHBsaWNhdGlvbk1lbnUubW9ja0NsZWFyKCk7XG4gIG1vY2tBcHBNZW51LnVwZGF0ZUFwcGxpY2F0aW9uTWVudS5tb2NrQ2xlYXIoKTtcblxuICBtb2NrSXBjSGFuZGxlcnMuc2V0dXBJcGNNYWluTGlzdGVuZXJzLm1vY2tDbGVhcigpO1xuXG4gIC8vIFN0b3JlIG1vY2sgaW5zdGFuY2UgbmVlZHMgc3BlY2lhbCBoYW5kbGluZyB0byBwcmVzZXJ2ZSBpbXBsZW1lbnRhdGlvblxuICBjb25zdCBnZXRJbXBsID0gbW9ja1N0b3JlSW5zdGFuY2UuZ2V0LmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICBjb25zdCBzZXRJbXBsID0gbW9ja1N0b3JlSW5zdGFuY2Uuc2V0LmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICBjb25zdCBzYXZlV2luZG93U3RhdGVzSW1wbCA9IG1vY2tTdG9yZUluc3RhbmNlLnNhdmVXaW5kb3dTdGF0ZXMuZ2V0TW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gIGNvbnN0IGdldFdpbmRvd1N0YXRlc0ltcGwgPSBtb2NrU3RvcmVJbnN0YW5jZS5nZXRXaW5kb3dTdGF0ZXMuZ2V0TW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gIGNvbnN0IGNsZWFyV2luZG93U3RhdGVzSW1wbCA9IG1vY2tTdG9yZUluc3RhbmNlLmNsZWFyV2luZG93U3RhdGVzLmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICBjb25zdCBnZXRBbGxJbXBsID0gbW9ja1N0b3JlSW5zdGFuY2UuZ2V0QWxsLmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICBjb25zdCBzZXRBbGxJbXBsID0gbW9ja1N0b3JlSW5zdGFuY2Uuc2V0QWxsLmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICBjb25zdCBmb3JjZVNhdmVJbXBsID0gbW9ja1N0b3JlSW5zdGFuY2UuZm9yY2VTYXZlLmdldE1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gIG1vY2tTdG9yZUluc3RhbmNlLmdldC5tb2NrQ2xlYXIoKTtcbiAgbW9ja1N0b3JlSW5zdGFuY2Uuc2V0Lm1vY2tDbGVhcigpO1xuICBtb2NrU3RvcmVJbnN0YW5jZS5zYXZlV2luZG93U3RhdGVzLm1vY2tDbGVhcigpO1xuICBtb2NrU3RvcmVJbnN0YW5jZS5nZXRXaW5kb3dTdGF0ZXMubW9ja0NsZWFyKCk7XG4gIG1vY2tTdG9yZUluc3RhbmNlLmNsZWFyV2luZG93U3RhdGVzLm1vY2tDbGVhcigpO1xuICBtb2NrU3RvcmVJbnN0YW5jZS5nZXRBbGwubW9ja0NsZWFyKCk7XG4gIG1vY2tTdG9yZUluc3RhbmNlLnNldEFsbC5tb2NrQ2xlYXIoKTtcbiAgbW9ja1N0b3JlSW5zdGFuY2UuZm9yY2VTYXZlLm1vY2tDbGVhcigpO1xuXG4gIGlmIChnZXRJbXBsKSBtb2NrU3RvcmVJbnN0YW5jZS5nZXQubW9ja0ltcGxlbWVudGF0aW9uKGdldEltcGwpO1xuICBpZiAoc2V0SW1wbCkgbW9ja1N0b3JlSW5zdGFuY2Uuc2V0Lm1vY2tJbXBsZW1lbnRhdGlvbihzZXRJbXBsKTtcbiAgaWYgKHNhdmVXaW5kb3dTdGF0ZXNJbXBsKSBtb2NrU3RvcmVJbnN0YW5jZS5zYXZlV2luZG93U3RhdGVzLm1vY2tJbXBsZW1lbnRhdGlvbihzYXZlV2luZG93U3RhdGVzSW1wbCk7XG4gIGlmIChnZXRXaW5kb3dTdGF0ZXNJbXBsKSBtb2NrU3RvcmVJbnN0YW5jZS5nZXRXaW5kb3dTdGF0ZXMubW9ja0ltcGxlbWVudGF0aW9uKGdldFdpbmRvd1N0YXRlc0ltcGwpO1xuICBpZiAoY2xlYXJXaW5kb3dTdGF0ZXNJbXBsKSBtb2NrU3RvcmVJbnN0YW5jZS5jbGVhcldpbmRvd1N0YXRlcy5tb2NrSW1wbGVtZW50YXRpb24oY2xlYXJXaW5kb3dTdGF0ZXNJbXBsKTtcbiAgaWYgKGdldEFsbEltcGwpIG1vY2tTdG9yZUluc3RhbmNlLmdldEFsbC5tb2NrSW1wbGVtZW50YXRpb24oZ2V0QWxsSW1wbCk7XG4gIGlmIChzZXRBbGxJbXBsKSBtb2NrU3RvcmVJbnN0YW5jZS5zZXRBbGwubW9ja0ltcGxlbWVudGF0aW9uKHNldEFsbEltcGwpO1xuICBpZiAoZm9yY2VTYXZlSW1wbCkgbW9ja1N0b3JlSW5zdGFuY2UuZm9yY2VTYXZlLm1vY2tJbXBsZW1lbnRhdGlvbihmb3JjZVNhdmVJbXBsKTtcblxuICBtb2NrRmlyc3RMYXVuY2guaGFuZGxlRmlyc3RMYXVuY2gubW9ja0NsZWFyKCk7XG5cbiAgbW9ja0VsZXZlbnR5LmdldEN1cnJlbnRMaXZlU2VydmVyVXJsLm1vY2tDbGVhcigpO1xuICBtb2NrRWxldmVudHkuaXNMaXZlU2VydmVyUmVhZHkubW9ja0NsZWFyKCk7XG4gIG1vY2tFbGV2ZW50eS5zZXRMaXZlU2VydmVyVXJsLm1vY2tDbGVhcigpO1xuICBtb2NrRWxldmVudHkuc2V0Q3VycmVudFdlYnNpdGVOYW1lLm1vY2tDbGVhcigpO1xuXG4gIG1vY2tIdHRwc1Byb3h5LmNyZWF0ZUh0dHBzUHJveHkubW9ja0NsZWFyKCk7XG4gIG1vY2tIdHRwc1Byb3h5LnJlc3RhcnRIdHRwc1Byb3h5Lm1vY2tDbGVhcigpO1xuXG4gIG1vY2tIb3N0c01hbmFnZXIuYWRkTG9jYWxEbnNSZXNvbHV0aW9uLm1vY2tDbGVhcigpO1xuICBtb2NrSG9zdHNNYW5hZ2VyLmNsZWFudXBIb3N0c0ZpbGUubW9ja0NsZWFyKCk7XG4gIG1vY2tIb3N0c01hbmFnZXIuY2hlY2tBbmRTdWdnZXN0VG91Y2hJZFNldHVwLm1vY2tDbGVhcigpO1xuXG4gIG1vY2tUaGVtZU1hbmFnZXIuaW5pdGlhbGl6ZS5tb2NrQ2xlYXIoKTtcbiAgbW9ja1RoZW1lTWFuYWdlci5hcHBseVRoZW1lVG9XaW5kb3cubW9ja0NsZWFyKCk7XG5cbiAgbW9ja1dlYnNpdGVNYW5hZ2VyLmNyZWF0ZVdlYnNpdGVXaXRoTmFtZS5tb2NrQ2xlYXIoKTtcbiAgbW9ja1dlYnNpdGVNYW5hZ2VyLnZhbGlkYXRlV2Vic2l0ZU5hbWUubW9ja0NsZWFyKCk7XG4gIG1vY2tXZWJzaXRlTWFuYWdlci5saXN0V2Vic2l0ZXMubW9ja0NsZWFyKCk7XG4gIG1vY2tXZWJzaXRlTWFuYWdlci5nZXRXZWJzaXRlUGF0aC5tb2NrQ2xlYXIoKTtcbiAgbW9ja1dlYnNpdGVNYW5hZ2VyLnJlbmFtZVdlYnNpdGUubW9ja0NsZWFyKCk7XG4gIG1vY2tXZWJzaXRlTWFuYWdlci5kZWxldGVXZWJzaXRlLm1vY2tDbGVhcigpO1xuXG4gIG1vY2tUZW1wbGF0ZUxvYWRlci5sb2FkVGVtcGxhdGVBc0RhdGFVcmwubW9ja0NsZWFyKCk7XG59O1xuXG5leHBvcnQge1xuICBtb2NrV2luZG93TWFuYWdlcixcbiAgbW9ja011bHRpV2luZG93TWFuYWdlcixcbiAgbW9ja0FwcE1lbnUsXG4gIG1vY2tJcGNIYW5kbGVycyxcbiAgbW9ja1N0b3JlSW5zdGFuY2UsXG4gIG1vY2tGaXJzdExhdW5jaCxcbiAgbW9ja0VsZXZlbnR5LFxuICBtb2NrSHR0cHNQcm94eSxcbiAgbW9ja0hvc3RzTWFuYWdlcixcbiAgbW9ja1RoZW1lTWFuYWdlcixcbiAgbW9ja1dlYnNpdGVNYW5hZ2VyLFxuICBtb2NrVGVtcGxhdGVMb2FkZXIsXG59O1xuIl0sInZlcnNpb24iOjN9